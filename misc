User Input
   ↓
phi3:mini (Intent Classifier)
   ↓
────────────────────────────
OPEN_APP           → System Plugin (NO LLM)
VOLUME_CONTROL     → System Plugin
SYSTEM_STATUS      → System Plugin
GENERAL_CHAT(short)→ phi3
GENERAL_CHAT(long) → llama3:instruct
SEARCH              → mistral
CODE_HELP           → deepseek-coder
UNKNOWN             → llama3:instruct



changed to plugin based architecutre

┌───────────────────────┐
│        USER           │
│  (text / voice input) │
└───────────┬───────────┘
            │
            ▼
┌───────────────────────┐
│   INTENT / MODE       │
│   DETECTION           │
│  (general / code /    │
│   search / command)   │
└───────────┬───────────┘
            │
            ▼
┌────────────────────────────────────────┐
│              CHAT ROUTER                │
│          (ChatModel)                    │
│                                        │
│  • Chooses model                        │
│  • Chooses tool                         │
│  • Controls context                     │
└───────────┬────────────────────────────┘
            │
            │  (Memory Layer lives here)
            ▼
┌────────────────────────────────────────┐
│            MEMORY LAYER                 │
│                                        │
│  ┌──────────────────────────────────┐  │
│  │ Raw Conversation Store            │  │
│  │ (SQLite - conversations table)   │  │
│  └───────────────┬──────────────────┘  │
│                  │                     │
│                  ▼                     │
│  ┌──────────────────────────────────┐  │
│  │ Rolling Summary Brain             │  │
│  │ (llama3:instruct)                 │  │
│  │                                  │  │
│  │  • Compresses old turns           │  │
│  │  • Preserves goals & context      │  │
│  │  • Deletes safely                 │  │
│  └───────────────┬──────────────────┘  │
│                  │                     │
│                  ▼                     │
│  ┌──────────────────────────────────┐  │
│  │ Context Assembler                 │  │
│  │                                  │  │
│  │  System Prompt                    │  │
│  │  + Conversation Summary           │  │
│  │  + Recent Turns (last N)          │  │
│  └──────────────────────────────────┘  │
└───────────┬────────────────────────────┘
            │
            ▼
┌───────────────────────┐
│      MODEL CALL       │
│  (phi3 / llama3 /     │
│   code / tools)       │
└───────────┬───────────┘
            │
            ▼
┌───────────────────────┐
│    RESPONSE OUTPUT    │
│                                        │
│  • User sees reply                     │
│  • Assistant stores response           │
└───────────────────────┘


User Message
   ↓
Stored in Memory
   ↓
(If long) → Summarize
   ↓
Summary Updated
   ↓
Recent Context Built
   ↓
Model Responds
   ↓
Response Stored
